<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>Basketbol Modu</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      background-color: #222;
      touch-action: none;
    }
    canvas {
      display: block;
      background: #222;
    }
  </style>
</head>
<body>
  <canvas id="gameCanvas"></canvas>
  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");

    let width = window.innerWidth;
    let height = window.innerHeight;
    canvas.width = width;
    canvas.height = height;

    const kafaImg = new Image();
    let kafaId = localStorage.getItem("seciliKafa") || "1";
    kafaImg.src = `kafa${kafaId}.png`;

    let kafa = {
      x: width / 2,
      y: height - 100,
      radius: 40,
      vx: 0,
      vy: 0,
      gravity: 0.5,
      isDragging: false,
      isFlying: false
    };

    let dragStart = null;
    let dragEnd = null;

    function draw() {
      ctx.clearRect(0, 0, width, height);

      // Draw kafa
      ctx.drawImage(kafaImg, kafa.x - kafa.radius, kafa.y - kafa.radius, kafa.radius * 2, kafa.radius * 2);

      // Draw trajectory
      if (kafa.isDragging && dragStart) {
        ctx.fillStyle = "white";
        const dx = dragStart.x - dragEnd.x;
        const dy = dragStart.y - dragEnd.y;
        for (let i = 0; i < 20; i++) {
          let t = i * 2;
          let px = kafa.x + dx * 0.1 * t;
          let py = kafa.y + dy * 0.1 * t + 0.5 * kafa.gravity * t * t;
          ctx.beginPath();
          ctx.arc(px, py, 3, 0, Math.PI * 2);
          ctx.fill();
        }
      }
    }

    function update() {
      if (kafa.isFlying) {
        kafa.vy += kafa.gravity;
        kafa.x += kafa.vx;
        kafa.y += kafa.vy;

        // Basit yerden seken mantık
        if (kafa.y + kafa.radius > height) {
          kafa.y = height - kafa.radius;
          kafa.vy *= -0.5;
          kafa.vx *= 0.8;
        }

        // Kenarlara çarpınca sekme
        if (kafa.x - kafa.radius < 0 || kafa.x + kafa.radius > width) {
          kafa.vx *= -1;
          kafa.x = Math.max(kafa.radius, Math.min(kafa.x, width - kafa.radius));
        }
      }

      draw();
      requestAnimationFrame(update);
    }

    function getPointerPos(e) {
      if (e.touches) {
        return { x: e.touches[0].clientX, y: e.touches[0].clientY };
      } else {
        return { x: e.clientX, y: e.clientY };
      }
    }

    function onStart(e) {
      const pos = getPointerPos(e);
      if (
        pos.x >= kafa.x - kafa.radius &&
        pos.x <= kafa.x + kafa.radius &&
        pos.y >= kafa.y - kafa.radius &&
        pos.y <= kafa.y + kafa.radius
      ) {
        kafa.isDragging = true;
        dragStart = pos;
        dragEnd = pos;
        kafa.isFlying = false;
        kafa.vx = 0;
        kafa.vy = 0;
      }
    }

    function onMove(e) {
      if (kafa.isDragging) {
        dragEnd = getPointerPos(e);
      }
    }

    function onEnd(e) {
      if (kafa.isDragging) {
        const dx = dragStart.x - dragEnd.x;
        const dy = dragStart.y - dragEnd.y;
        kafa.vx = dx * 0.15;
        kafa.vy = dy * 0.15;
        kafa.isFlying = true;
        kafa.isDragging = false;
      }
    }

    canvas.addEventListener("mousedown", onStart);
    canvas.addEventListener("mousemove", onMove);
    canvas.addEventListener("mouseup", onEnd);

    canvas.addEventListener("touchstart", onStart);
    canvas.addEventListener("touchmove", onMove);
    canvas.addEventListener("touchend", onEnd);

    update();
  </script>
</body>
</html>
