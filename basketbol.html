<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Basketbol Modu</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      margin: 0;
      background: #111;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      color: white;
      font-family: sans-serif;
      flex-direction: column;
      overflow: hidden;
      overflow-x: hidden;
    }
    canvas {
      border: 2px solid white;
    }
    .score {
      font-size: 24px;
      margin-bottom: 20px;
    }
    .btn {
      padding: 10px 20px;
      font-size: 18px;
      cursor: pointer;
      background: #fff;
      border: none;
      border-radius: 10px;
      color: #111;
    }
  </style>
</head>
<body>

  <h1>Basketbol Modu</h1>
  <div class="score" id="score">Skor: 0</div>
  <canvas id="canvas"></canvas>
  <button class="btn" onclick="goBack()">Geri</button>

  <script>
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    let width, height;
    let score = 0;

    // Kafa seçimi için localStorage'dan okuma
    const selectedKafaId = localStorage.getItem('seciliKafa');
    const kafaImg = new Image();
    kafaImg.src = `kafa${selectedKafaId}.png`; // seçilen kafa resmini yükle

    // Potanın görseli
    const basketImg = new Image();
    basketImg.src = 'pota.png'; // Potayı buradan yükle (pota görselinin dosya ismi ve yolu)

    // Canvas boyutları
    function resize() {
      const dpr = window.devicePixelRatio || 1;
      canvas.width = window.innerWidth * dpr;
      canvas.height = window.innerHeight * dpr;
      canvas.style.width = window.innerWidth + 'px';
      canvas.style.height = window.innerHeight + 'px';
      ctx.setTransform(1, 0, 0, 1, 0, 0);
      ctx.scale(dpr, dpr);
      width = window.innerWidth;
      height = window.innerHeight;
    }

    window.addEventListener('resize', resize);
    resize();

    // Kafa (top) özellikleri
    let kafa = {
      x: width / 2,
      y: height - 50,
      radius: 40, // Kafanın yarıçapı (daha büyük yapabilirsin)
      speedX: 0,
      speedY: 0,
      gravity: 0.5,
      bounce: 0.7
    };

    // Basketbol potası
    let basket = {
      x: Math.random() * (width - 120),
      y: Math.random() * (height / 2), // Potayı ekrana yerleştirme
      width: 100,
      height: 50
    };

    // Oyun döngüsü
    function gameLoop() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Potayı çizme
      ctx.drawImage(basketImg, basket.x, basket.y, basket.width, basket.height);

      // Kafayı (topu) çizme
      ctx.drawImage(kafaImg, kafa.x - kafa.radius, kafa.y - kafa.radius, kafa.radius * 2, kafa.radius * 2);

      // Kafayı hareket ettirme
      kafa.y += kafa.speedY;
      kafa.speedY += kafa.gravity; // Yerçekimi etkisi

      // Yere çarptığında sekmesi
      if (kafa.y + kafa.radius >= height) {
        kafa.y = height - kafa.radius;
        kafa.speedY = -kafa.speedY * kafa.bounce;
      }

      // Basket kontrolü
      if (kafa.y + kafa.radius >= basket.y && kafa.y - kafa.radius <= basket.y + basket.height &&
          kafa.x + kafa.radius >= basket.x && kafa.x - kafa.radius <= basket.x + basket.width) {
        score += 1;
        document.getElementById('score').innerText = 'Skor: ' + score;
        resetBall(); // Basket olduğunda topu sıfırla
      }

      requestAnimationFrame(gameLoop);
    }

    // Topu sıfırlamak
    function resetBall() {
      kafa.x = width / 2;
      kafa.y = height - 50;
      kafa.speedY = 0;
    }

    // Geri butonu
    function goBack() {
      window.location.href = 'index.html';
    }

    // Sürükleme işlemleri
    let dragging = false;
    let startX, startY;

    canvas.addEventListener('mousedown', (e) => {
      const rect = canvas.getBoundingClientRect();
      startX = e.clientX - rect.left;
      startY = e.clientY - rect.top;

      // Eğer kafaya tıklanmışsa, sürükleme başlat
      if (Math.sqrt(Math.pow(startX - kafa.x, 2) + Math.pow(startY - kafa.y, 2)) < kafa.radius) {
        dragging = true;
      }
    });

    canvas.addEventListener('mousemove', (e) => {
      if (dragging) {
        const rect = canvas.getBoundingClientRect();
        const x = e.clientX - rect.left;
        const y = e.clientY - rect.top;

        // Kafayı yeni pozisyona taşı
        kafa.x = x;
        kafa.y = y;
      }
    });

    canvas.addEventListener('mouseup', (e) => {
      if (dragging) {
        dragging = false;

        // Topu fırlat
        const endX = e.clientX - canvas.getBoundingClientRect().left;
        const endY = e.clientY - canvas.getBoundingClientRect().top;

        // Fırlatma yönü ve gücü hesapla
        const directionX = (endX - kafa.x) / 10;
        const directionY = (endY - kafa.y) / 10;

        kafa.speedX = directionX;
        kafa.speedY = directionY;

        // Yönü ve hızıyla topu fırlat
      }
    });

    gameLoop(); // Oyunu başlat
  </script>

</body>
</html>
